# nbhosting.conf

# the upstream component nginx needs to connect to
upstream django {
    # a file socket to reach the upstream django app
    server unix:/run/nbhosting.sock; 
}

# configuration of the server
server {

    # the port your site will be served on
#    listen      443 ssl;
    listen      443;
    # the domain name it will serve for
    server_name nbhosting.inria.fr; 
    charset     utf-8;

    error_log    /var/log/nginx.log;
    rewrite_log on;

    ########## SSL config    
#    ssl_certificate      /etc/ssl/certs/mooc-python-proxy.inria.fr.pem;
#    ssl_certificate_key  /etc/ssl/private/mooc-python-proxy.inria.fr.key;
#
#    # Protect against the BEAST attack by preferring RC4-SHA when using SSLv3 and TLS protocols.
#    # Note that TLSv1.1 and TLSv1.2 are immune to the beast attack
#    # but only work with OpenSSL v1.0.1 and higher and has limited client support.
#    ssl_protocols              TLSv1 TLSv1.1 TLSv1.2;
#    ssl_ciphers                HIGH:RC4:!EXPORT:!ADH:!MD5;
#    ssl_prefer_server_ciphers  on;
#
#    # Optimize SSL by caching session parameters for 10 minutes.
#    # This cuts down on the number of expensive SSL handshakes.
#    # The handshake is the most CPU-intensive operation,
#    # and by default it is re-negotiated on every new/parallel connection.
#    # By enabling a cache (of type "shared between all Nginx workers"),
#    # we tell the client to re-use the already negotiated state.
#    # Further optimization can be achieved by raising keepalive_timeout,
#    # but that shouldn't be done unless you serve primarily HTTPS.
#    ssl_session_cache    shared:SSL:10m; # a 1mb cache can hold about 4000 sessions,
#                                         # so we can hold about 40000 sessions
#    ssl_session_timeout  10m;


# max upload size
    client_max_body_size 75M;   # adjust to taste

#    # Django media
#    location /media  {
#        alias /root/poc/foo/media;  # your Django project's media files - amend as required
#    }
#    location /static {
#        alias /root/poc/foo/static; # your Django project's static files - amend as required
#    }

    # the URLS that go to django
#    location /ipythonExercice/ {
    location / {
        uwsgi_pass  django;
        include     uwsgi_params; # the uwsgi_params file you installed
    }
}
